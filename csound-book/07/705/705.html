<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>instr 705</title>	</head>	<body bgcolor="white">		<table cool width="603" height="915" border="0" cellpadding="0" cellspacing="0" gridx="16" showgridx usegridx gridy="16" showgridy usegridy>			<tr height="1" cntrlrow>				<td width="1" height="1"></td>				<td width="600" height="1"><spacer type="block" width="600" height="1"></td>			</tr>			<tr height="32">				<td width="1" height="32"><spacer type="block" width="1" height="32"></td>				<td width="600" height="32" colspan="1" rowspan="1" valign="top" align="left" xpos="0" content csheight="32"><font size="4"><b>instr 705</b></font></td>			</tr>			<tr height="16">				<td width="1" height="16"><spacer type="block" width="1" height="16"></td>				<td width="600" height="16" colspan="1" rowspan="1" valign="top" align="left" xpos="0"><embed src="../../../Book%20Audio/0705.mov" width="112" height="16" autoplay="false" controller="true" cache="true"></td>			</tr>			<tr height="32">				<td width="1" height="32"><spacer type="block" width="1" height="32"></td>				<td width="600" height="32" colspan="1" rowspan="1" valign="top" align="left" xpos="0" content csheight="32"><a href="../705.orc">705.orc</a></td>			</tr>			<tr height="32">				<td width="1" height="32"><spacer type="block" width="1" height="32"></td>				<td width="600" height="32" colspan="1" rowspan="1" valign="top" align="left" xpos="0" content csheight="32"><a href="../705.sco">705.sco</a></td>			</tr>			<tr height="768">				<td width="1" height="768"><spacer type="block" width="1" height="768"></td>				<td width="600" height="768" colspan="1" rowspan="1" valign="top" align="left" xpos="0">					<table cellspacing="0" border="0" cellpadding="0" width="600">						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td width="12%" valign="top"><font face="Courier New" size="2">instr</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">705</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">; full legato INSTRUMENT with &quot;chiff&quot;</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">idur</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">abs(p3)</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; main init block</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ipch1</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">cpspch(p6)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ipch2</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">cpspch(p5)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">kpch</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">ipch2</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iport</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0.02</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; tight pitch</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iatt</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0.02</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; and amplitude ramps</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">idec</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">p10</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; get decay from score</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">irise</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">idur*p9</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; set swell peak position</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td width="12%" valign="top">&nbsp;</td>							<td valign="top" colspan="4">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; ... (ifall set later)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">idovib</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; assume we use vibrato</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">icut</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">(p5 &gt; 9.01 ? 4000 : 2500)</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; trim highest partials</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td width="12%" valign="top">&nbsp;</td>							<td valign="top" colspan="4">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; assume this is a tied note</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iamp</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">p4</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; tied note starts at score amp</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">i1</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">-1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; phase for tied note</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">i2</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">-1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; phase for vibrato</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ir</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">tival</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">; TIED NOTE?</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; conditional init block</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td width="12%" valign="top"><font face="Courier New" size="2">tigoto</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">tie</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">i1</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; first note, reset phase</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">i2</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0.25</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; cosine phase for vibrato</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iamp</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; set start amp</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iatt</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0.08</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; stretch attack if first note</font></td>						</tr>						<tr>							<td valign="top" colspan="7"><font face="Courier New" size="2">tie:</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iadjust</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">iatt+idec</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; long note, we're safe</font></td>						</tr>						<tr>							<td valign="top" colspan="6"><font face="Courier New" size="2">if idur &gt;= iadjust igoto doamp</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; adjust ramp durations for</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iatt</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">(idur/2)-0.005</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; ... short notes, 10msec limit</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">idec</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">iatt</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; can't have zero timespan</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iadjust</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">idur-0.01</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; (ensure ilen != 0 for linseg)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">idovib</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; no vibrato on short notes</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">iport</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">0.005</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; even tighter pitch ramp</font></td>						</tr>						<tr>							<td valign="top" colspan="7"><font face="Courier New" size="2">doamp:</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ilen</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">idur-iadjust</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; make amplitude ramp</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">amp</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">linseg</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">iamp, iatt, p4, ilen, p4, idec, p7</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td width="12%" valign="top">&nbsp;</td>							<td valign="top" colspan="4">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; add chiff on first note</font></td>						</tr>						<tr>							<td valign="top" colspan="6"><font face="Courier New" size="2">if ir == 1 goto pitch</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; no chiff on tied notes</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ichiff</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">p4/10</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; match chiff to volume of note</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td width="12%" valign="top">&nbsp;</td>							<td valign="top" colspan="4">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; balance chiffs with register</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ifac1</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">(p5 &gt; 9.01 ? 3.0 : 1.)</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; (avoid division at audio...</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ifac2</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">(p5 &gt; 9.01 ? 0.1 : 0.2)</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; ...rates)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">aramp</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">linseg</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">0, 0.005, ichiff, 0.02, ichiff*0.5, 0.05, 0, 0, 0</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">anoise</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">rand</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">aramp</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">achiff1</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">reson</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">anoise, 3000, 500, 1, 1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; 2 filters for fixed hf chiff,</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">achiff2</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">reson</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">anoise, 6000, 1000, 1, 1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; ... with rescaling</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">achiff3</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">reson</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">anoise,ipch2*2, 20, 0, 1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; one filter for pitched chiff,</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">achiff</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">(achiff1+achiff2)*ifac1+(achiff3*ifac2)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">pitch:</font></td>							<td width="12%" valign="top">&nbsp;</td>							<td valign="top" colspan="4">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; make pitch ramp</font></td>						</tr>						<tr>							<td valign="top" colspan="5"><font face="Courier New" size="2">if ir == 0 || p6 == p5 kgoto expr</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">;skip ptchramp gen if 1st note or tie</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">kpramp</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">linseg</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">ipch1, iport, ipch2, idur-iport, ipch2</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">kpch</font></td>							<td width="12%" valign="top"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="5"><font face="Courier New" size="2">kpramp</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">expr:</font></td>							<td width="12%" valign="top">&nbsp;</td>							<td valign="top" colspan="4">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; make expression envelope</font></td>						</tr>						<tr>							<td valign="top" colspan="7"><font face="Courier New" size="2">; p8 sets peak of expression point, p9 moves it if p9==0 (illegal for linseg)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">irise</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">(p9&gt;0.?irise:iatt)</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; set maximum accent shape</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">ifall</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">idur-irise</font></td>						</tr>						<tr>							<td valign="top" colspan="7"><font face="Courier New" size="2">; make sure a neg p8 does not take amp below zero</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">p8</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">((p8+p4) &gt; 0. ? p8 : -p4)</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">aslur</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">linseg</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">0, irise, p8, ifall, 0</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; make vibrato</font></td>						</tr>						<tr>							<td valign="top" colspan="6"><font face="Courier New" size="2">if idovib == 0 goto play</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; skip vibrato if short note</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">avib</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">oscili</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">0.5, 4.5, 2, 0.25</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; med speed, assume sine f2</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">avib</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">avib+0.5</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">aslur</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">aslur*avib</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">play:</font></td>							<td valign="top" colspan="2">&nbsp;</td>							<td valign="top" colspan="3">&nbsp;</td>							<td width="40%" valign="top"><font face="Courier New" size="2">; make the note</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">aamp</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">=</font></td>							<td valign="top" colspan="4"><font face="Courier New" size="2">amp+aslur</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">aflute</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">oscili</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">aamp, kpch, 1, i1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; trim partials of high</font></td>						</tr>						<tr>							<td width="11%" valign="top"><font face="Courier New" size="2">asig</font></td>							<td valign="top" colspan="2"><font face="Courier New" size="2">butterlp</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">aflute, icut, 1</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; ... notes, no reinit</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td valign="top" colspan="2"><font face="Courier New" size="2">out</font></td>							<td valign="top" colspan="3"><font face="Courier New" size="2">asig+achiff*0.25</font></td>							<td width="40%" valign="top"><font face="Courier New" size="2">; final scaling of chiff</font></td>						</tr>						<tr>							<td width="11%" valign="top">&nbsp;</td>							<td valign="top" colspan="6"><font face="Courier New" size="2">endin</font></td>						</tr>					</table>				</td>			</tr>			<tr height="32">				<td width="1" height="32"><spacer type="block" width="1" height="32"></td>				<td width="600" height="32" colspan="1" rowspan="1" valign="top" align="left" xpos="0" content csheight="32"></td>			</tr>		</table>	</body></html>